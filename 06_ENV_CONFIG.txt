# Environment Configuration Blueprint - PROPER 2.9

## Purpose
Define comprehensive environment setup, configuration management, security keys, deployment settings, and operational parameters for the PROPER 2.9 AI-Enhanced Hotel Security Platform across all environments (development, staging, production) with enterprise-grade security and compliance.

## Project Environment Overview

### Project Configuration Information
```
Project Name: PROPER 2.9 AI-Enhanced Hotel Security Platform
Configuration Management Strategy: AWS Systems Manager Parameter Store + HashiCorp Vault
Environment Count: 4 (Development, Testing, Staging, Production)
Security Classification: Confidential - Enterprise Security Platform
Compliance Requirements: SOC 2 Type II, ISO 27001, GDPR, CCPA, PCI DSS Level 1
Multi-Region Deployment: Primary (US-East-1), Secondary (EU-West-1), Backup (AP-Southeast-1)
```

## Environment Structure

### Environment Definitions
```
Development Environment:
- Purpose: Local and shared development with realistic security test scenarios
- Access Level: All developers with 2FA, VPN required for external access
- Data Classification: Anonymized production data with synthetic security scenarios
- Uptime Requirements: 95% during business hours (no SLA for off-hours)
- Backup Requirements: Daily snapshots, 7-day retention for rapid iteration

Staging Environment:
- Purpose: Production-like testing with full security validation and compliance testing
- Access Level: QA team, DevOps, security team, limited developer access
- Data Classification: Production-equivalent with anonymized PII, real security configurations
- Uptime Requirements: 99% availability with 4-hour recovery SLA
- Backup Requirements: Daily backups, 30-day retention, cross-region replication

Production Environment:
- Purpose: Live hotel security operations with 24/7 emergency response capability
- Access Level: Operations team only, emergency break-glass procedures documented
- Data Classification: Live customer data, real security events, compliance audit trails
- Uptime Requirements: 99.9% availability with <5-minute RTO for emergency systems
- Backup Requirements: Continuous replication, 7-year compliance retention, geo-distributed

Testing Environment:
- Purpose: Automated testing, security penetration testing, compliance validation
- Access Level: CI/CD systems, security testing team, compliance auditors
- Data Classification: Synthetic data matching production schemas, security test scenarios
- Uptime Requirements: 90% availability, ephemeral for specific test runs
- Backup Requirements: Test data snapshots, 14-day retention for debugging
```

## Core Configuration Variables

### Application Configuration
```
# Application Settings
APP_NAME=proper29-platform
APP_VERSION=2.9.0
APP_ENVIRONMENT={dev|staging|production}
APP_DEBUG={false for staging/prod, true for dev}
APP_LOG_LEVEL={debug|info|warning|error}
APP_TIMEZONE=UTC
APP_LOCALE=en_US
APP_URL=https://{env}.proper29.com
APP_PORT={8000-8007 per service}

# Security Feature Flags
FEATURE_BIOMETRIC_AUTH=true
FEATURE_AI_PREDICTIONS=true
FEATURE_PANIC_BUTTON=true
FEATURE_FACIAL_RECOGNITION=true
FEATURE_IOT_MONITORING=true
FEATURE_CYBERSECURITY_MONITORING=true
FEATURE_GUEST_SAFETY_APP=true
FEATURE_PREDICTIVE_ANALYTICS=true
FEATURE_BEHAVIORAL_ANALYTICS=true
FEATURE_COMPLIANCE_AUTOMATION=true

# Performance Settings
MAX_REQUEST_SIZE=100MB
REQUEST_TIMEOUT=30s
CONNECTION_POOL_SIZE=20
WORKER_PROCESSES=8
THREAD_POOL_SIZE=16
EMERGENCY_API_TIMEOUT=5s
PANIC_BUTTON_TIMEOUT=2s
```

### Database Configuration
```
# Primary Database (PostgreSQL 15+ with TimescaleDB)
DB_CONNECTION=postgresql
DB_HOST={environment-specific-host}
DB_PORT=5432
DB_NAME=proper29_{environment}
DB_USERNAME=proper29_app
DB_PASSWORD={vault:database/proper29/password}
DB_SSL_MODE=require
DB_CHARSET=UTF8
DB_COLLATION=en_US.UTF-8

# Database Pool Settings
DB_POOL_MIN_SIZE=5
DB_POOL_MAX_SIZE=25
DB_POOL_TIMEOUT=30s
DB_POOL_RECYCLE=3600s
DB_STATEMENT_TIMEOUT=60s
DB_LOCK_TIMEOUT=30s

# Read Replica Configuration
DB_READ_HOST={environment-read-replica-host}
DB_READ_PORT=5432
DB_READ_USERNAME=proper29_read
DB_READ_PASSWORD={vault:database/proper29_read/password}
DB_READ_POOL_SIZE=15

# TimescaleDB Configuration
TIMESCALEDB_ENABLED=true
TIMESCALEDB_CHUNK_TIME_INTERVAL=24h
TIMESCALEDB_RETENTION_POLICY=2y
TIMESCALEDB_COMPRESSION_ENABLED=true

# Cache Database (Redis Cluster)
REDIS_HOST={environment-redis-cluster}
REDIS_PORT=6379
REDIS_PASSWORD={vault:redis/proper29/password}
REDIS_DB_NUMBER=0
REDIS_SSL=true
REDIS_TIMEOUT=5s
REDIS_CLUSTER_ENABLED=true
REDIS_MAX_CONNECTIONS=100

# Analytics Database (OpenSearch)
OPENSEARCH_HOST={environment-opensearch-cluster}
OPENSEARCH_PORT=443
OPENSEARCH_USERNAME=proper29_analytics
OPENSEARCH_PASSWORD={vault:opensearch/proper29/password}
OPENSEARCH_INDEX_PREFIX=proper29_{environment}
OPENSEARCH_SSL=true
OPENSEARCH_TIMEOUT=30s

# Vector Database (Pinecone for AI/ML)
PINECONE_API_KEY={vault:pinecone/proper29/api_key}
PINECONE_ENVIRONMENT={pinecone-environment}
PINECONE_INDEX_NAME=proper29-security-vectors
PINECONE_DIMENSIONS=512
PINECONE_METRIC=cosine
```

### Security & Authentication
```
# Application Security
SECRET_KEY={vault:app/proper29/secret_key}
JWT_SECRET={vault:jwt/proper29/secret}
JWT_ALGORITHM=HS256
JWT_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d
JWT_EMERGENCY_EXPIRATION=24h

# Encryption Keys
ENCRYPTION_KEY={vault:encryption/proper29/primary}
FIELD_ENCRYPTION_KEY={vault:encryption/proper29/field}
FILE_ENCRYPTION_KEY={vault:encryption/proper29/file}
BIOMETRIC_ENCRYPTION_KEY={vault:encryption/proper29/biometric}
VIDEO_ENCRYPTION_KEY={vault:encryption/proper29/video}

# Multi-Factor Authentication
MFA_ENABLED=true
MFA_ISSUER=PROPER29_Security
MFA_TOTP_WINDOW=30s
MFA_BACKUP_CODES_COUNT=8
MFA_REQUIRED_ROLES=admin,security_manager

# OAuth Configuration (Enterprise SSO)
OAUTH_CLIENT_ID={vault:oauth/proper29/client_id}
OAUTH_CLIENT_SECRET={vault:oauth/proper29/client_secret}
OAUTH_REDIRECT_URI=https://{env}.proper29.com/auth/callback
OAUTH_SCOPE=openid profile email groups

# Enterprise Identity Providers
AZURE_AD_TENANT_ID={vault:azure/proper29/tenant_id}
AZURE_AD_CLIENT_ID={vault:azure/proper29/client_id}
AZURE_AD_CLIENT_SECRET={vault:azure/proper29/client_secret}

OKTA_DOMAIN={vault:okta/proper29/domain}
OKTA_CLIENT_ID={vault:okta/proper29/client_id}
OKTA_CLIENT_SECRET={vault:okta/proper29/client_secret}

# API Security
API_RATE_LIMIT_PER_MINUTE=100
API_RATE_LIMIT_EMERGENCY=1000
API_RATE_LIMIT_PANIC_BUTTON=unlimited
API_KEY_HEADER_NAME=X-PROPER29-API-Key
CORS_ALLOWED_ORIGINS=https://*.proper29.com,https://*.hotel-partner.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_CREDENTIALS=true
```

### External Service Integrations
```
# Email Service (Enterprise Transactional)
MAIL_DRIVER=smtp
MAIL_HOST={vault:email/proper29/host}
MAIL_PORT=587
MAIL_USERNAME={vault:email/proper29/username}
MAIL_PASSWORD={vault:email/proper29/password}
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=security@proper29.com
MAIL_FROM_NAME=PROPER29 Security Platform

# Emergency Email Configuration
EMERGENCY_EMAIL_HOST={vault:email/emergency/host}
EMERGENCY_EMAIL_USERNAME={vault:email/emergency/username}
EMERGENCY_EMAIL_PASSWORD={vault:email/emergency/password}
EMERGENCY_EMAIL_RECIPIENTS=security-ops@proper29.com,emergency@proper29.com

# Cloud Storage (AWS S3 with encryption)
CLOUD_STORAGE_PROVIDER=s3
CLOUD_STORAGE_KEY={vault:aws/proper29/access_key}
CLOUD_STORAGE_SECRET={vault:aws/proper29/secret_key}
CLOUD_STORAGE_REGION=us-east-1
CLOUD_STORAGE_BUCKET=proper29-{environment}-storage
CLOUD_STORAGE_URL=https://proper29-{environment}-storage.s3.amazonaws.com
CLOUD_STORAGE_ENCRYPTION=AES256
CLOUD_STORAGE_KMS_KEY_ID={vault:aws/proper29/kms_key_id}

# Video Storage (Specialized for security footage)
VIDEO_STORAGE_BUCKET=proper29-{environment}-video
VIDEO_STORAGE_RETENTION_DAYS=2555  # 7 years for compliance
VIDEO_STORAGE_ARCHIVAL_DAYS=90     # Move to IA after 90 days
VIDEO_STORAGE_ENCRYPTION=aws:kms

# Payment Processing (Stripe for billing)
PAYMENT_PROVIDER=stripe
STRIPE_PUBLIC_KEY={vault:stripe/proper29/public_key}
STRIPE_SECRET_KEY={vault:stripe/proper29/secret_key}
STRIPE_WEBHOOK_SECRET={vault:stripe/proper29/webhook_secret}
STRIPE_CONNECT_CLIENT_ID={vault:stripe/proper29/connect_client_id}

# Analytics & Monitoring
ANALYTICS_PROVIDER=datadog
DATADOG_API_KEY={vault:datadog/proper29/api_key}
DATADOG_APP_KEY={vault:datadog/proper29/app_key}
DATADOG_SITE=datadoghq.com
DATADOG_SERVICE_NAME=proper29-{service}
DATADOG_ENV={environment}

# Error Tracking
ERROR_TRACKING_DSN={vault:sentry/proper29/dsn}
ERROR_TRACKING_ENVIRONMENT={environment}
ERROR_TRACKING_RELEASE=proper29@{version}
ERROR_TRACKING_SAMPLE_RATE=1.0

# Application Performance Monitoring
APM_SERVICE_NAME=proper29-{service}
APM_SERVER_URL={vault:datadog/proper29/apm_url}
APM_SECRET_TOKEN={vault:datadog/proper29/apm_token}
APM_ENVIRONMENT={environment}
APM_TRACE_SAMPLE_RATE=1.0
```

### Messaging & Communication
```
# Message Queue (AWS SQS with EventBridge)
MESSAGE_QUEUE_PROVIDER=sqs
SQS_ACCESS_KEY={vault:aws/proper29/sqs_access_key}
SQS_SECRET_KEY={vault:aws/proper29/sqs_secret_key}
SQS_REGION=us-east-1
SQS_QUEUE_PREFIX=proper29-{environment}
SQS_DEAD_LETTER_QUEUE_ENABLED=true

# Event Bridge Configuration
EVENTBRIDGE_BUS_NAME=proper29-{environment}-events
EVENTBRIDGE_REGION=us-east-1
EVENTBRIDGE_RETENTION_DAYS=30

# Background Jobs
QUEUE_CONNECTION=sqs
QUEUE_DEFAULT=proper29-{environment}-default
QUEUE_FAILED=proper29-{environment}-failed
QUEUE_HIGH_PRIORITY=proper29-{environment}-emergency
QUEUE_AI_PROCESSING=proper29-{environment}-ai

# WebSocket Configuration (Real-time updates)
WEBSOCKET_HOST={environment-websocket-host}
WEBSOCKET_PORT=443
WEBSOCKET_SSL=true
WEBSOCKET_PATH=/socket.io
WEBSOCKET_AUTH_REQUIRED=true
WEBSOCKET_RATE_LIMIT=1000/minute

# Push Notifications (Mobile apps)
FCM_SERVER_KEY={vault:firebase/proper29/server_key}
FCM_SENDER_ID={vault:firebase/proper29/sender_id}
FCM_PROJECT_ID=proper29-security-platform

APNS_KEY_ID={vault:apns/proper29/key_id}
APNS_TEAM_ID={vault:apns/proper29/team_id}
APNS_BUNDLE_ID=com.proper29.security
APNS_ENVIRONMENT={production|sandbox}
APNS_PRIVATE_KEY={vault:apns/proper29/private_key}

# Emergency Communication Services
TWILIO_ACCOUNT_SID={vault:twilio/proper29/account_sid}
TWILIO_AUTH_TOKEN={vault:twilio/proper29/auth_token}
TWILIO_PHONE_NUMBER={vault:twilio/proper29/phone_number}
TWILIO_EMERGENCY_PHONE_NUMBER={vault:twilio/proper29/emergency_number}

# Slack Integration (Operations alerts)
SLACK_WEBHOOK_URL={vault:slack/proper29/webhook_url}
SLACK_BOT_TOKEN={vault:slack/proper29/bot_token}
SLACK_CHANNEL=#proper29-security-alerts
SLACK_EMERGENCY_CHANNEL=#proper29-emergency-alerts
```

### Business Logic Configuration
```
# Security Business Rules
MAX_UPLOAD_SIZE=500MB
ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf,mp4,avi,mov,doc,docx,xls,xlsx
ALLOWED_VIDEO_TYPES=mp4,avi,mov,webm,mkv
SESSION_LIFETIME=480  # 8 hours for security staff
SESSION_EMERGENCY_LIFETIME=1440  # 24 hours for emergency situations
PASSWORD_MIN_LENGTH=12
PASSWORD_COMPLEXITY_REQUIRED=true
LOGIN_ATTEMPTS_LIMIT=5
ACCOUNT_LOCKOUT_DURATION=30  # 30 minutes

# Hotel Security Configuration
MAX_PROPERTIES_PER_ENTERPRISE=unlimited
MAX_USERS_PER_PROPERTY=500
MAX_GUARDS_PER_SHIFT=50
MAX_CONCURRENT_PATROLS=20
INCIDENT_AUTO_ESCALATION_TIME=15m
PANIC_BUTTON_RESPONSE_SLA=120s  # 2 minutes
EMERGENCY_LOCKDOWN_TIMEOUT=30s

# AI/ML Configuration
AI_PREDICTION_CONFIDENCE_THRESHOLD=0.85
AI_MODEL_REFRESH_INTERVAL=24h
AI_TRAINING_DATA_RETENTION=2y
BEHAVIORAL_ANALYSIS_WINDOW=7d
PATTERN_DETECTION_SENSITIVITY=medium
ANOMALY_DETECTION_THRESHOLD=0.95

# Pricing & Billing
CURRENCY=USD
TAX_RATE=0.08  # Default 8% - overridden by property location
SUBSCRIPTION_TRIAL_DAYS=30
PAYMENT_GRACE_PERIOD_DAYS=7
ENTERPRISE_DISCOUNT_THRESHOLD=100  # properties

# Content & Media
CDN_URL=https://cdn.proper29.com
MEDIA_URL=https://media.proper29.com
STATIC_URL=https://static.proper29.com
IMAGE_QUALITY=85  # JPEG quality for security images
VIDEO_QUALITY=720p  # Default video quality for storage efficiency
VIDEO_COMPRESSION_CODEC=h264
IMAGE_THUMBNAIL_SIZE=300x300

# Search & Indexing
SEARCH_ENABLED=true
SEARCH_INDEX_PREFIX=proper29_{environment}
SEARCH_RESULTS_PER_PAGE=25
SEARCH_TIMEOUT=10s
SEARCH_FUZZY_MATCHING=true
SEARCH_FACETED_ENABLED=true

# Internationalization
DEFAULT_LANGUAGE=en
SUPPORTED_LANGUAGES=en,es,fr,de,zh,ja,ko
TIMEZONE_DETECTION=true
CURRENCY_CONVERSION_API={vault:currency/api_key}
LOCALIZATION_AUTO_DETECT=true
```

## Environment-Specific Configurations

### Development Environment (.env.development)
```
# Development-specific settings
APP_DEBUG=true
APP_LOG_LEVEL=debug
APP_ENVIRONMENT=development
APP_URL=https://dev.proper29.com

# Development database (local Docker)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=proper29_dev
DB_USERNAME=proper29_dev
DB_PASSWORD=dev_password_2024
DB_SSL_MODE=disable

# Development cache (local Redis)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB_NUMBER=0
REDIS_SSL=false

# Development email (local MailHog)
MAIL_DRIVER=smtp
MAIL_HOST=localhost
MAIL_PORT=1025
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_ENCRYPTION=

# Development storage (local MinIO)
CLOUD_STORAGE_PROVIDER=s3
CLOUD_STORAGE_KEY=minioadmin
CLOUD_STORAGE_SECRET=minioadmin
CLOUD_STORAGE_BUCKET=proper29-dev-storage
CLOUD_STORAGE_URL=http://localhost:9000
CLOUD_STORAGE_REGION=us-east-1
CLOUD_STORAGE_ENDPOINT=http://localhost:9000

# Development payment (Stripe test mode)
STRIPE_SECRET_KEY=sk_test_dev_key_here
STRIPE_PUBLIC_KEY=pk_test_dev_key_here

# Development monitoring (disabled for performance)
ERROR_TRACKING_DSN=
APM_ENABLED=false
ANALYTICS_ENABLED=false
DATADOG_ENABLED=false

# Development security (relaxed for testing)
CORS_ALLOWED_ORIGINS=*
API_RATE_LIMIT_PER_MINUTE=10000
JWT_EXPIRATION=24h
MFA_ENABLED=false

# Development AI/ML (local models)
AI_MODEL_PATH=./models/dev
AI_PREDICTION_ENABLED=true
AI_TRAINING_ENABLED=true
ML_GPU_ENABLED=false

# Development performance (low resource usage)
MAX_REQUEST_SIZE=10MB
WORKER_PROCESSES=2
CONNECTION_POOL_SIZE=5
BACKGROUND_JOB_WORKERS=2

# Development integrations (mock services)
PMS_INTEGRATION_ENABLED=false
IOT_SENSORS_ENABLED=false
VIDEO_MANAGEMENT_ENABLED=false
BIOMETRIC_DEVICES_ENABLED=false
```

### Staging Environment (.env.staging)
```
# Staging-specific settings
APP_DEBUG=false
APP_LOG_LEVEL=info
APP_ENVIRONMENT=staging
APP_URL=https://staging.proper29.com

# Staging database (AWS RDS)
DB_HOST=proper29-staging-cluster.cluster-xyz.us-east-1.rds.amazonaws.com
DB_PORT=5432
DB_NAME=proper29_staging
DB_USERNAME=proper29_staging
DB_PASSWORD={vault:database/staging/password}
DB_SSL_MODE=require

# Staging read replica
DB_READ_HOST=proper29-staging-reader.cluster-xyz.us-east-1.rds.amazonaws.com
DB_READ_USERNAME=proper29_staging_read
DB_READ_PASSWORD={vault:database/staging_read/password}

# Staging cache (AWS ElastiCache)
REDIS_HOST=proper29-staging-redis.abc123.cache.amazonaws.com
REDIS_PORT=6379
REDIS_PASSWORD={vault:redis/staging/password}
REDIS_SSL=true

# Staging email (AWS SES)
MAIL_DRIVER=smtp
MAIL_HOST=email-smtp.us-east-1.amazonaws.com
MAIL_PORT=587
MAIL_USERNAME={vault:aws/ses/staging/username}
MAIL_PASSWORD={vault:aws/ses/staging/password}
MAIL_ENCRYPTION=tls

# Staging storage (AWS S3)
CLOUD_STORAGE_PROVIDER=s3
CLOUD_STORAGE_KEY={vault:aws/staging/access_key}
CLOUD_STORAGE_SECRET={vault:aws/staging/secret_key}
CLOUD_STORAGE_BUCKET=proper29-staging-storage
CLOUD_STORAGE_REGION=us-east-1
CDN_URL=https://staging-cdn.proper29.com

# Staging payment (Stripe test mode)
STRIPE_SECRET_KEY={vault:stripe/staging/secret_key}
STRIPE_PUBLIC_KEY={vault:stripe/staging/public_key}

# Staging monitoring (full monitoring enabled)
ERROR_TRACKING_DSN={vault:sentry/staging/dsn}
APM_ENABLED=true
ANALYTICS_ENABLED=true
DATADOG_API_KEY={vault:datadog/staging/api_key}
DATADOG_APP_KEY={vault:datadog/staging/app_key}

# Staging security (production-like)
CORS_ALLOWED_ORIGINS=https://staging.proper29.com,https://staging-admin.proper29.com
API_RATE_LIMIT_PER_MINUTE=500
JWT_EXPIRATION=30m
MFA_ENABLED=true

# Staging AI/ML (production models)
AI_MODEL_PATH=s3://proper29-staging-models/
AI_PREDICTION_ENABLED=true
AI_TRAINING_ENABLED=true
ML_GPU_ENABLED=true
PINECONE_ENVIRONMENT=staging

# Staging performance (moderate resources)
MAX_REQUEST_SIZE=50MB
WORKER_PROCESSES=4
CONNECTION_POOL_SIZE=15
BACKGROUND_JOB_WORKERS=4

# Staging integrations (test integrations)
PMS_INTEGRATION_ENABLED=true
PMS_TEST_MODE=true
IOT_SENSORS_ENABLED=true
VIDEO_MANAGEMENT_ENABLED=true
BIOMETRIC_DEVICES_ENABLED=true
```

### Production Environment (.env.production)
```
# Production-specific settings
APP_DEBUG=false
APP_LOG_LEVEL=warning
APP_ENVIRONMENT=production
APP_URL=https://app.proper29.com

# Production database (AWS RDS Multi-AZ)
DB_HOST=proper29-prod-cluster.cluster-abc123.us-east-1.rds.amazonaws.com
DB_PORT=5432
DB_NAME=proper29_production
DB_USERNAME=proper29_prod
DB_PASSWORD={vault:database/production/password}
DB_SSL_MODE=require

# Production read replicas (multiple for load distribution)
DB_READ_HOST=proper29-prod-reader.cluster-abc123.us-east-1.rds.amazonaws.com
DB_READ_USERNAME=proper29_prod_read
DB_READ_PASSWORD={vault:database/production_read/password}

# Production cache (AWS ElastiCache Cluster)
REDIS_HOST=proper29-prod-redis.abc123.clustercfg.use1.cache.amazonaws.com
REDIS_PORT=6379
REDIS_PASSWORD={vault:redis/production/password}
REDIS_SSL=true
REDIS_CLUSTER_ENABLED=true

# Production email (AWS SES with dedicated IP)
MAIL_DRIVER=smtp
MAIL_HOST=email-smtp.us-east-1.amazonaws.com
MAIL_PORT=587
MAIL_USERNAME={vault:aws/ses/production/username}
MAIL_PASSWORD={vault:aws/ses/production/password}
MAIL_ENCRYPTION=tls

# Production storage (AWS S3 with CloudFront)
CLOUD_STORAGE_PROVIDER=s3
CLOUD_STORAGE_KEY={vault:aws/production/access_key}
CLOUD_STORAGE_SECRET={vault:aws/production/secret_key}
CLOUD_STORAGE_BUCKET=proper29-production-storage
CLOUD_STORAGE_REGION=us-east-1
CDN_URL=https://cdn.proper29.com

# Production video storage (specialized bucket)
VIDEO_STORAGE_BUCKET=proper29-production-video
VIDEO_STORAGE_CDN_URL=https://video-cdn.proper29.com

# Production payment (Stripe live mode)
STRIPE_SECRET_KEY={vault:stripe/production/secret_key}
STRIPE_PUBLIC_KEY={vault:stripe/production/public_key}
STRIPE_WEBHOOK_SECRET={vault:stripe/production/webhook_secret}

# Production monitoring (comprehensive)
ERROR_TRACKING_DSN={vault:sentry/production/dsn}
APM_ENABLED=true
ANALYTICS_ENABLED=true
DATADOG_API_KEY={vault:datadog/production/api_key}
DATADOG_APP_KEY={vault:datadog/production/app_key}
DATADOG_SITE=datadoghq.com

# Production security (strict)
CORS_ALLOWED_ORIGINS=https://app.proper29.com,https://admin.proper29.com,https://mobile.proper29.com
API_RATE_LIMIT_PER_MINUTE=100
API_RATE_LIMIT_EMERGENCY=10000
JWT_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d
MFA_ENABLED=true
MFA_REQUIRED_ROLES=admin,security_manager,compliance_officer

# Production AI/ML (optimized models)
AI_MODEL_PATH=s3://proper29-production-models/
AI_PREDICTION_ENABLED=true
AI_TRAINING_ENABLED=true
ML_GPU_ENABLED=true
PINECONE_ENVIRONMENT=production
AI_MODEL_CACHE_ENABLED=true
AI_BATCH_SIZE=64

# Production performance (high performance)
MAX_REQUEST_SIZE=100MB
WORKER_PROCESSES=8
CONNECTION_POOL_SIZE=25
BACKGROUND_JOB_WORKERS=12
ASYNC_WORKER_CONCURRENCY=100

# Production integrations (live integrations)
PMS_INTEGRATION_ENABLED=true
PMS_TEST_MODE=false
IOT_SENSORS_ENABLED=true
VIDEO_MANAGEMENT_ENABLED=true
BIOMETRIC_DEVICES_ENABLED=true
FACIAL_RECOGNITION_ENABLED=true
```

## Security & Key Management

### Secret Management Strategy
```
Secret Management System: HashiCorp Vault with AWS Systems Manager Parameter Store backup
- Primary: HashiCorp Vault for sensitive secrets and dynamic secrets
- Backup: AWS Systems Manager Parameter Store for configuration parameters

Secret Categories:
- Database credentials: Vault dynamic secrets with automatic rotation
- API keys: Vault KV store with manual rotation quarterly
- Encryption keys: Vault transit engine with automatic key rotation
- Certificates: Vault PKI engine with automatic certificate management
- OAuth secrets: Vault KV store with semi-annual rotation

Secret Rotation Policy:
- Database passwords: Automatic rotation every 30 days
- API keys: Quarterly rotation with 30-day overlap
- JWT secrets: Monthly rotation with graceful key rollover
- Encryption keys: Annual rotation with backward compatibility
- Certificates: Automatic renewal 30 days before expiration

Access Control:
- Development environment: Developer role with limited secret access
- Staging environment: QA and DevOps roles with staging secret access
- Production environment: Production operations role only, break-glass procedures
- Emergency access: Security team with audit logging and approval workflow
```

### Key Generation Guidelines
```
Encryption Key Generation:
# Generate 256-bit AES encryption key
openssl rand -hex 32

# Generate JWT secret (512-bit base64)
openssl rand -base64 64

# Generate database password (32 characters, URL-safe)
openssl rand -base64 32 | tr -d "=+/" | cut -c1-32

# Generate API key (64 characters, hex)
openssl rand -hex 32

Key Storage Format:
- Environment variables: VAULT:{path/to/secret}
- Configuration files: ${vault:secret_path}
- Secret management: JSON with metadata and rotation info
- Container secrets: Kubernetes secrets with Vault injection

Key Validation:
- Key strength requirements: Minimum 256-bit entropy for encryption
- Key format validation: Base64/hex encoding validation
- Key rotation validation: Automated testing of new keys before activation
- Key backup verification: Cross-region backup validation
```

## Configuration Management

### Configuration File Structure
```
config/
├── app.yaml                           # Core application configuration
├── database.yaml                      # Database connection settings
├── cache.yaml                         # Redis and caching configuration
├── security.yaml                      # Security and authentication settings
├── integrations.yaml                  # External service configurations
├── ai-ml.yaml                         # AI/ML model and pipeline settings
├── monitoring.yaml                    # Logging, metrics, and alerting
├── compliance.yaml                    # Compliance and audit settings
└── environments/                      # Environment-specific overrides
    ├── development.yaml
    ├── staging.yaml
    ├── production.yaml
    └── testing.yaml
```

### Configuration Validation
```
Validation Strategy: JSON Schema validation with custom security checks

Required Variables Validation:
- DATABASE_URL: PostgreSQL connection string format with SSL requirement
- ENCRYPTION_KEYS: 256-bit hex or base64 encoded keys
- JWT_SECRET: Minimum 256-bit entropy
- API_ENDPOINTS: HTTPS URLs with valid domains
- COMPLIANCE_SETTINGS: SOC 2, GDPR, PCI DSS configuration completeness

Format Validation:
- URL format: https://[subdomain.]domain.tld[/path] with certificate validation
- Email format: RFC 5322 compliant with MX record validation
- Number range: Performance thresholds within acceptable operational limits
- Boolean values: true/false/1/0 with type coercion

Environment Consistency:
- Cross-environment validation: Staging must mirror production configuration structure
- Migration validation: Database schema compatibility across environments
- Dependency validation: Service dependency graph validation and health checks
- Security validation: Encryption key rotation status and certificate expiration
```

## Monitoring & Logging Configuration

### Logging Configuration
```
# Logging Settings
LOG_CHANNEL=combined
LOG_LEVEL={debug|info|warning|error|critical}
LOG_MAX_FILES=30
LOG_MAX_SIZE=100MB
LOG_RETENTION_DAYS=90

# Log Destinations
LOG_FILE_PATH=/var/log/proper29/{service}.log
LOG_ELASTICSEARCH_HOST=proper29-{env}-logs.es.amazonaws.com
LOG_ELASTICSEARCH_INDEX=proper29-{env}-logs
LOG_DATADOG_ENABLED=true
LOG_SYSLOG_FACILITY=local0

# Log Formatting
LOG_FORMAT=json
LOG_TIMESTAMP_FORMAT=ISO8601
LOG_INCLUDE_CONTEXT=true
LOG_SANITIZE_SENSITIVE=true
LOG_CORRELATION_ID_ENABLED=true

# Structured Logging
STRUCTURED_LOGGING_ENABLED=true
LOG_REQUEST_ID_HEADER=X-Request-ID
LOG_USER_ID_FIELD=user_id
LOG_CORRELATION_ID_FIELD=correlation_id
LOG_TRACE_ID_FIELD=trace_id
LOG_SECURITY_EVENTS=true

# Security Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION=7y  # Compliance requirement
SECURITY_EVENT_LOG_ENABLED=true
COMPLIANCE_LOG_ENABLED=true
ACCESS_LOG_ENABLED=true
```

### Monitoring Configuration
```
# Application Monitoring
MONITORING_ENABLED=true
METRICS_ENDPOINT=/metrics
HEALTH_CHECK_ENDPOINT=/health
READINESS_CHECK_ENDPOINT=/ready
LIVENESS_CHECK_ENDPOINT=/live

# Performance Monitoring
PERFORMANCE_MONITORING_ENABLED=true
SLOW_QUERY_THRESHOLD=1000  # 1 second
SLOW_REQUEST_THRESHOLD=5000  # 5 seconds
MEMORY_USAGE_THRESHOLD=80  # 80%
CPU_USAGE_THRESHOLD=70  # 70%
EMERGENCY_RESPONSE_TIME_THRESHOLD=2000  # 2 seconds

# Custom Metrics
BUSINESS_METRICS_ENABLED=true
SECURITY_METRICS_ENABLED=true
INCIDENT_METRICS_ENABLED=true
PATROL_METRICS_ENABLED=true
GUEST_SAFETY_METRICS_ENABLED=true
AI_PREDICTION_METRICS_ENABLED=true
COMPLIANCE_METRICS_ENABLED=true

# Alerting
ALERTING_ENABLED=true
ALERT_EMAIL_RECIPIENTS=security-ops@proper29.com,devops@proper29.com
ALERT_SLACK_WEBHOOK={vault:slack/alerts/webhook}
ALERT_PAGERDUTY_KEY={vault:pagerduty/proper29/integration_key}
ALERT_EMERGENCY_PHONE={vault:twilio/emergency/phone}

# Security Monitoring
SECURITY_MONITORING_ENABLED=true
INTRUSION_DETECTION_ENABLED=true
ANOMALY_DETECTION_ENABLED=true
THREAT_INTELLIGENCE_ENABLED=true
COMPLIANCE_MONITORING_ENABLED=true
```

## Deployment Configuration

### Container Configuration
```
# Docker Settings
DOCKER_REGISTRY=proper29.dkr.ecr.us-east-1.amazonaws.com
DOCKER_IMAGE_TAG={git-commit-sha}
DOCKER_BUILD_ARGS=--build-arg ENV={environment}

# Container Runtime
CONTAINER_RUNTIME=containerd
CONTAINER_RESOURCES_CPU=2000m
CONTAINER_RESOURCES_MEMORY=4Gi
CONTAINER_HEALTH_CHECK_INTERVAL=30s
CONTAINER_STARTUP_TIMEOUT=300s

# Orchestration (Kubernetes)
ORCHESTRATION_PLATFORM=kubernetes
KUBERNETES_NAMESPACE=proper29-{environment}
KUBERNETES_CONTEXT=proper29-{environment}-cluster
KUBERNETES_CLUSTER_NAME=proper29-{environment}
KUBERNETES_REGION=us-east-1

# Service Mesh (Istio)
SERVICE_MESH_ENABLED=true
ISTIO_INJECTION=enabled
MTLS_MODE=STRICT
TRAFFIC_POLICY=round_robin
```

### Infrastructure Configuration
```
# Cloud Provider Settings (AWS)
CLOUD_PROVIDER=aws
CLOUD_REGION=us-east-1
CLOUD_AVAILABILITY_ZONES=us-east-1a,us-east-1b,us-east-1c
AWS_ACCOUNT_ID={vault:aws/proper29/account_id}

# Network Configuration
VPC_ID=vpc-proper29{environment}abc123
SUBNET_IDS=subnet-abc123,subnet-def456,subnet-ghi789
SECURITY_GROUP_IDS=sg-proper29-app,sg-proper29-db,sg-proper29-cache
LOAD_BALANCER_ARN=arn:aws:elasticloadbalancing:us-east-1:account:loadbalancer/app/proper29-{env}

# Auto Scaling
AUTO_SCALING_ENABLED=true
MIN_INSTANCES=3
MAX_INSTANCES=50
SCALE_UP_THRESHOLD=70  # CPU percentage
SCALE_DOWN_THRESHOLD=30  # CPU percentage
SCALE_UP_COOLDOWN=300s
SCALE_DOWN_COOLDOWN=600s

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=90
BACKUP_CROSS_REGION_ENABLED=true
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_STORAGE_LOCATION=s3://proper29-{environment}-backups

# Disaster Recovery
DR_ENABLED=true
DR_REGION=us-west-2
DR_RTO=4h  # Recovery Time Objective
DR_RPO=1h  # Recovery Point Objective
DR_AUTOMATED_FAILOVER=false  # Manual approval required
```

## Service-Specific Configurations

### Security Service Configuration
```
# Security Service Settings
SECURITY_SERVICE_PORT=8001
SECURITY_DB_POOL_SIZE=20
SECURITY_REDIS_DB=1

# Incident Management
INCIDENT_AUTO_ESCALATION_TIME=15m
INCIDENT_SLA_CRITICAL=30m
INCIDENT_SLA_HIGH=2h
INCIDENT_SLA_MEDIUM=8h
INCIDENT_SLA_LOW=24h

# Patrol Management
PATROL_GPS_ACCURACY_THRESHOLD=5m
PATROL_CHECKPOINT_TIMEOUT=5m
PATROL_ROUTE_OPTIMIZATION_ENABLED=true
PATROL_REAL_TIME_TRACKING=true

# Access Control
ACCESS_CONTROL_TIMEOUT=30s
BIOMETRIC_MATCH_THRESHOLD=0.95
DIGITAL_KEY_EXPIRATION=24h
ACCESS_LOG_RETENTION=2y
```

### AI/ML Service Configuration
```
# AI/ML Service Settings
AI_SERVICE_PORT=8002
AI_MODEL_CACHE_SIZE=10GB
AI_GPU_MEMORY_FRACTION=0.8

# Model Configuration
INCIDENT_PREDICTION_MODEL_PATH=s3://proper29-models/incident-prediction/latest
PATROL_OPTIMIZATION_MODEL_PATH=s3://proper29-models/patrol-optimization/latest
BEHAVIOR_ANALYSIS_MODEL_PATH=s3://proper29-models/behavior-analysis/latest
FACIAL_RECOGNITION_MODEL_PATH=s3://proper29-models/facial-recognition/latest

# Training Configuration
MODEL_TRAINING_SCHEDULE=0 3 * * 0  # Weekly on Sunday at 3 AM
TRAINING_DATA_SAMPLE_SIZE=100000
MODEL_VALIDATION_SPLIT=0.2
MODEL_ACCURACY_THRESHOLD=0.85

# Inference Configuration
PREDICTION_BATCH_SIZE=32
INFERENCE_TIMEOUT=10s
MODEL_WARM_UP_ENABLED=true
FEATURE_CACHE_TTL=1h
```

### Guest Safety Service Configuration
```
# Guest Safety Service Settings
GUEST_SAFETY_SERVICE_PORT=8003
GUEST_SAFETY_DB_POOL_SIZE=15
WEBSOCKET_CONNECTIONS_MAX=10000

# Panic Button Configuration
PANIC_BUTTON_RESPONSE_SLA=120s
PANIC_BUTTON_AUTO_LOCATION=true
PANIC_BUTTON_PHOTO_CAPTURE=true
PANIC_BUTTON_AUDIO_RECORDING=30s

# Emergency Response
EMERGENCY_CONTACTS_AUTO_DIAL=true
EMERGENCY_ESCALATION_TIME=5m
EMERGENCY_SERVICE_INTEGRATION=true
EMERGENCY_BROADCAST_RADIUS=100m

# Mobile App Configuration
MOBILE_APP_UPDATE_REQUIRED=false
MOBILE_OFFLINE_MODE_DURATION=24h
MOBILE_BACKGROUND_LOCATION=true
MOBILE_PUSH_NOTIFICATION_ENABLED=true
```

---

## Implementation Guidelines

### Environment Provisioning
1. **Infrastructure Setup**: Terraform scripts for environment creation
2. **Secret Management**: Vault cluster setup with proper access policies
3. **Database Setup**: Multi-AZ PostgreSQL with read replicas and backup
4. **Monitoring Setup**: Datadog integration with custom dashboards
5. **Security Setup**: WAF, DDoS protection, and intrusion detection
6. **Compliance Setup**: Audit logging and compliance monitoring

### Configuration Deployment
1. **Configuration Validation**: Automated validation before deployment
2. **Secret Injection**: Vault agent for dynamic secret injection
3. **Environment Sync**: Configuration consistency across environments
4. **Rollback Procedures**: Configuration rollback for failed deployments
5. **Change Management**: Configuration change approval workflow

### Operational Procedures
1. **Health Monitoring**: Comprehensive health checks and alerting
2. **Performance Optimization**: Regular performance tuning and optimization
3. **Security Updates**: Regular security patching and updates
4. **Compliance Auditing**: Continuous compliance monitoring and reporting
5. **Disaster Recovery**: Regular DR testing and recovery procedures

This comprehensive environment configuration blueprint ensures that the PROPER 2.9 AI-Enhanced Hotel Security Platform operates with enterprise-grade reliability, security, and compliance across all environments while maintaining optimal performance for critical hotel security operations.